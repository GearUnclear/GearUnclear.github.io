<style>
    /* Desktop hover functionality for navbar dropdowns */
    @media (min-width: 768px) {
        .navbar .dropdown:hover .dropdown-menu {
            display: block;
            margin-top: 0;
        }
        
        /* Smooth transition for desktop */
        .navbar .dropdown-menu {
            transition: all 0.2s ease-in-out;
        }
    }
</style>

<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
    <div class="container-fluid">
        <a class="navbar-brand" href="/">HH Data Team Infobase</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" 
                aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav me-auto mb-2 mb-md-0">
                <li class="nav-item">
                    <a class="nav-link" href="/">Home</a>
                </li>
                
                <!-- Apricot Help Dropdown -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="apricotDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Apricot Help
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="apricotDropdown">
                        <li><a class="dropdown-item" href="/Prog/">Program Lookup</a></li>
                        <li><a class="dropdown-item" href="/Entry/">Entry Procedures</a></li>
                        <li><a class="dropdown-item" href="/Exit/">Exit Procedures</a></li>
                        <li><a class="dropdown-item" href="/18/">18-Year-Old Assessments</a></li>
                        <li><a class="dropdown-item" href="/updates/">Update and Move-in Assessments</a></li>
                    </ul>
                </li>

                <!-- Policies & Procedures Dropdown -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="policiesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Policies & Procedures
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="policiesDropdown">
                        <li><a class="dropdown-item" href="/Crisis/" target="_blank">Crisis Response</a></li>
                        <li><a class="dropdown-item" href="/flowchart/">ADP Guide (Outdated)</a></li>
                    </ul>
                </li>

                <!-- Knowledge Dropdown -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="knowledgeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Knowledge
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="knowledgeDropdown">
                        <li><a class="dropdown-item" href="/definitions/">Definitions</a></li>
                        <li><a class="dropdown-item" href="/UnitDesignations/">Unit Types</a></li>
                    </ul>
                </li>

                <!-- Documents Dropdown -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="/documents/" id="documentsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Documents
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="documentsDropdown">
                        <li><a class="dropdown-item" href="/ADULT_FULL_ASSESSMENT.pdf" target="_blank">Adult Assessment (Entry/Exit)</a></li>
                        <li><a class="dropdown-item" href="/Annual Assessment.pdf" target="_blank">Annual Assessment</a></li>
                        <li><a class="dropdown-item" href="/CHILD_FULL_ASSESSMENT.pdf" target="_blank">Child Assessment (Entry/Exit)</a></li>
                        <li><a class="dropdown-item" href="/Exit from Homeless Housing Datasheet Guide2.pdf" target="_blank">Exit from Homeless Housing Datasheet Guide</a></li>
                        <li><a class="dropdown-item" href="/Fenn Jorstad.pdf" target="_blank">Fenn Jorstad (Required for Adult Assessments)</a></li>
                        <li><a class="dropdown-item" href="/Housing Stability Plan.pdf" target="_blank">Housing Stability Plan</a></li>
                        <li><a class="dropdown-item" href="/HMISROI.pdf" target="_blank">HMIS ROI</a></li>
                        <li><a class="dropdown-item" href="/Housing-Hope-ROI.docx" target="_blank">Housing Hope ROI</a></li>
                        <li><a class="dropdown-item" href="/Occupancy Departure Guide.pdf" target="_blank">Occupancy Departure Guide</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
    // Get the current path and filename
    var currentPath = window.location.pathname.split("/").pop();

    // Get all the nav links (both nav-link and dropdown-item)
    var navLinks = document.querySelectorAll('.nav-link, .dropdown-item');

    // Loop through the links to find the one that matches the current page
    navLinks.forEach(function(link) {
        if(link.getAttribute('href') === currentPath) {
            link.classList.add('active'); // Add the active class
            link.setAttribute('aria-current', 'page'); // Set aria-current attribute
            
            // If it's a dropdown item, also mark the parent dropdown as active
            var parentDropdown = link.closest('.dropdown');
            if(parentDropdown) {
                var dropdownToggle = parentDropdown.querySelector('.dropdown-toggle');
                if(dropdownToggle) {
                    dropdownToggle.classList.add('active');
                }
            }
        }
    });
</script>
